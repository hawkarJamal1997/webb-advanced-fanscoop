<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fanscoop</title>

    <style>
        main > .page{
            display: none;
        }

        main > .page.current-page{
            display: block;
        }
    </style>

    <script>

        const BACKEND_URI = "http://localhost:8000/"

        document.addEventListener("DOMContentLoaded", function(){


            showPage(location.pathname)

            document.body.addEventListener("click", function(event){
                
                const clickedElement = event.target

                if(clickedElement.tagName == "A"){

                    if(clickedElement.hostname == location.hostname){
                       
                        event.preventDefault()

                        const uri = clickedElement.getAttribute("href")

                        if(location.pathname != uri){

                            hideCurrentPage()
                            showPage(uri)

                            history.pushState({}, "", uri)
                        }
                    }
                }
            })
        })

       window.addEventListener("popstate", function(event){
            
            const uri = location.pathname
            hideCurrentPage()
            showPage(uri)
        })

        function showPage(uri){
            let pageToshow = ""
            switch(uri){
                case "/":
                    pageToshow = "home-page"
                    break
                case "/accounts":
                    pageToshow = "accounts-page"
                    loadAllAccounts()
                    break
                case "/clubs":
                    pageToshow = "clubs-page"
                    break
                case "/posts":
                    pageToshow = "posts"
                case "/about":
                    pageToshow = "about-page"
                    break
                default:
                    pageToshow = "not-found-page"
            }

            document.getElementById(pageToshow).classList.add("current-page")
          
        }

        function hideCurrentPage(){
            document.querySelector(".current-page").classList.remove("current-page")
        }
    
        async function loadAllAccounts(){

            const page = document.getElementById("accounts-page")

            const h1 = document.createElement("h1")
            h1.innerText = "All humans"
            page.appendChild(h1)

            const response = await fetch(BACKEND_URI+"Apiaccounts")
        
            switch(response.status){
                case 200:
                    const accounts = await response.json()

                    const ul = document.createElement("ul")
                    const h1 = document.createElement("h1")
                    h1.innerText  = "heh"
                    page.appendChild(h1)

                    for(const account of accounts){
                        const li = document.createElement("li")
                        li.innerHTML = account.username
                        ul.appendChild(li)
                    }
                    page.appendChild(ul)
                    break
                case 500:
                    break
                default:
            }
        }
    </script>
</head>
<body>
    <nav class="nav">
        <div class="navbar-start">
            <a href="/" class="navbar-item">home</a>
            <a href="/accounts" class="navbar-item">Accounts</a>
            <a href="/clubs" class="navbar-item">Clubs</a>
            <a href="/posts" class="navbar-item">Posts</a>
            <a href="/contact" class="navbar-item">Contact</a>
            <a href="/about" class="navbar-item">About</a>
        </div>
    </nav>

    <main>
        <div class="page" id="home-page">
            <h1>Home</h1>
            <p>welcome</p>
            <p>more <a href="/about" class="navbar-item">About</a></p>
        </div>

        <div class="page" id="accounts-page">
            <h1>Accounts</h1>
            <p>this is accounts</p>
            <p>more <a href="/contact" class="navbar-item">contact</a></p>
        </div>

        <div class="page" id="clubs-page">
            <h1>clubs</h1>
            <p>this is clubs</p>
            <p>more <a href="/contact" class="navbar-item">contact</a></p>
        </div>
        

        <div class="page" id="about-page">
            <h1>About</h1>
            <p>this is about</p>
            <p>more <a href="/contact" class="navbar-item">contact</a></p>
        </div>


        <div class="page" id="not-found-page">
            <h1>not found</h1>
            <p>error</p>
            <p>more <a href="/contact" class="navbar-item">contact</a></p>
        </div>
    </main>

</body>
</html>